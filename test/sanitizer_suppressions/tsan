# ThreadSanitizer suppressions
# ============================
#
# https://github.com/google/sanitizers/wiki/ThreadSanitizerSuppressions

# double locks (TODO fix)
mutex:g_genesis_wait_mutex
mutex:Interrupt
mutex:CThreadInterrupt
mutex:CConnman::Interrupt
mutex:CConnman::WakeMessageHandler
mutex:CConnman::ThreadOpenConnections
mutex:CConnman::ThreadOpenAddedConnections
mutex:CConnman::SocketHandler
mutex:UpdateTip
mutex:PeerManagerImpl::UpdatedBlockTip
mutex:g_best_block_mutex

# race (TODO fix)
race:CConnman::WakeMessageHandler
race:CConnman::ThreadMessageHandler
race:fHaveGenesis
race:ProcessNewBlock
race:ThreadImport
race:LoadWallet
race:WalletBatch::WriteHDChain
race:BerkeleyBatch
race:BerkeleyDatabase
race:DatabaseBatch
race:leveldb::DBImpl::DeleteObsoleteFiles
race:zmq::*
race:bitcoin-qt

# deadlock (TODO fix)
deadlock:CChainState::ConnectTip

# Intentional deadlock in tests
deadlock:TestPotentialDeadLockDetected

# Wildcard for all gui tests, should be replaced with non-wildcard suppressions
race:src/qt/test/*
deadlock:src/qt/test/*

# Race in src/test/main.cpp
# Can be removed once upgraded to boost test 1.74 in depends
race:validation_chainstatemanager_tests

# External libraries
deadlock:libdb
race:libzmq
<<<<<<< HEAD

# Intermittent issues
# -------------------
#
# Suppressions that follow might only happen intermittently, thus they are not
# reproducible. Make sure to include a link to a full trace.

# https://github.com/bitcoin/bitcoin/issues/20618
race:CZMQAbstractPublishNotifier::SendZmqMessage

# https://github.com/bitcoin/bitcoin/pull/20218, https://github.com/bitcoin/bitcoin/pull/20745
race:epoll_ctl
||||||| merged common ancestors
=======

# Disable spurious error about std::cout.
# data race /usr/lib/llvm-10/bin/../include/c++/v1/ios:522:12 in std::__1::ios_base::width() const
# Location is global 'std::__1::cout' of size 160 at 0x7f492785e270 (libc++.so.1+0x0000000c0290)
# https://travis-ci.org/github/bitcoin/bitcoin/jobs/695004018
#
# Uses of std::cout are guaranteed thread safe by the c++ standard
# https://stackoverflow.com/questions/50322790/thread-safety-and-piping-to-streams
race:std::__1::ios_base::width
>>>>>>> util: Release logger lock while calling log callbacks
